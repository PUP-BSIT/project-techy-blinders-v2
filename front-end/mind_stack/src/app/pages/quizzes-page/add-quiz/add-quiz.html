<div class="modal-overlay" [hidden]="!isOpen" [attr.aria-hidden]="!isOpen" (click)="onBackdropClick($event)">
    <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="create-study-set-container">
            <h1 class="page-title">Create new quiz</h1>

            <div class="question-title-section">
                <h2 class="section-title">Quiz Title</h2>
                <div class="title-card">
                    <input type="text" 
                            class="title-input" 
                            placeholder="Enter the title of your quiz"
                            [(ngModel)]="quizTitle"
                            name="quizTitle">
                    <textarea class="description-input" 
                                placeholder="Enter the Description in here..."
                                [(ngModel)]="quizDescription"
                                name="quizDescription"
                                rows="5">
                    </textarea>
                </div>
            </div>

            <div class="questions-section">
                <h2 class="section-title">Add Questions</h2>
                
                <div class="question-type-buttons">
                    <button type="button" 
                            class="question-type-btn" 
                            [class.active]="selectedQuestionType === QuestionType.MULTIPLE_CHOICE"
                            (click)="selectQuestionType(QuestionType.MULTIPLE_CHOICE)">
                        <span class="icon-small" aria-hidden="true">&#10003;</span>
                        Multiple Choice
                    </button>
                    <button type="button" 
                            class="question-type-btn" 
                            [class.active]="selectedQuestionType === QuestionType.TRUE_FALSE"
                            (click)="selectQuestionType(QuestionType.TRUE_FALSE)">
                        <span class="icon-small" aria-hidden="true">&#10133;</span>
                        True/False
                    </button>
                </div>

                <div class="questions-container">
                    <ng-container #questionsContainer></ng-container>

                    <ng-template #questionTpl let-question="question" let-i="index">
                        <div class="question-card">
                            <div class="question-header">
                                <span class="question-number">Question {{ i + 1 }}</span>
                                <button type="button" 
                                        class="delete-question-btn" 
                                        (click)="removeQuestion(i)" 
                                        title="Delete question">
                                    <span class="icon-small" aria-hidden="true">&#128465;</span>
                                </button>
                            </div>
                            <div class="question-inputs">
                                <div class="input-group">
                                    <input type="text" 
                                            class="question-input" 
                                            placeholder="Type your question here..."
                                            [(ngModel)]="question.question"
                                            [name]="'question' + i">
                                    <label class="input-label">Question</label>
                                </div>

                                <div class="options-container" 
                                        [hidden]="selectedQuestionType !== QuestionType.MULTIPLE_CHOICE" 
                                        [attr.aria-hidden]="selectedQuestionType !== QuestionType.MULTIPLE_CHOICE">

                                    <div class="input-group option-group">
                                        <input type="text" 
                                                class="question-input option-input" 
                                                placeholder="Option A"
                                                [(ngModel)]="question.optionA"
                                                [name]="'optionA' + i">
                                        <label class="input-label">Option A</label>
                                    </div>
                                    <div class="input-group option-group">
                                        <input type="text" 
                                                class="question-input option-input" 
                                                placeholder="Option B"
                                                [(ngModel)]="question.optionB"
                                                [name]="'optionB' + i">
                                        <label class="input-label">Option B</label>
                                    </div>
                                    <div class="input-group option-group">
                                        <input type="text" 
                                                class="question-input option-input" 
                                                placeholder="Option C"
                                                [(ngModel)]="question.optionC"
                                                [name]="'optionC' + i">
                                        <label class="input-label">Option C</label>
                                    </div>
                                    <div class="input-group option-group">
                                        <input type="text" 
                                                class="question-input option-input" 
                                                placeholder="Option D"
                                                [(ngModel)]="question.optionD"
                                                [name]="'optionD' + i">
                                        <label class="input-label">Option D</label>
                                    </div>
                                    
                                    <div class="correct-answer-section">
                                        <label class="correct-answer-label">Correct Answer:</label>
                                        <div class="correct-answer-buttons">
                                            <button type="button" 
                                                    class="answer-option-btn" 
                                                    [class.active]="question.correctAnswer === 'A'"
                                                    (click)="selectCorrectAnswer(i, 'A')">
                                                A
                                            </button>
                                            <button type="button" 
                                                    class="answer-option-btn" 
                                                    [class.active]="question.correctAnswer === 'B'"
                                                    (click)="selectCorrectAnswer(i, 'B')">
                                                B
                                            </button>
                                            <button type="button" 
                                                    class="answer-option-btn" 
                                                    [class.active]="question.correctAnswer === 'C'"
                                                    (click)="selectCorrectAnswer(i, 'C')">
                                                C
                                            </button>
                                            <button type="button" 
                                                    class="answer-option-btn" 
                                                    [class.active]="question.correctAnswer === 'D'"
                                                    (click)="selectCorrectAnswer(i, 'D')">
                                                D
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="true-false-container" 
                                        [hidden]="selectedQuestionType !== QuestionType.TRUE_FALSE" 
                                        [attr.aria-hidden]="selectedQuestionType !== QuestionType.TRUE_FALSE">

                                    <div class="input-group">
                                        <label class="input-label">Correct Answer:</label>
                                        <div class="true-false-buttons">
                                            <button type="button" 
                                                    class="true-false-btn" 
                                                    [class.active]="question.answer === 'True'"
                                                    (click)="question.answer = 'True'">
                                                True
                                            </button>
                                            <button type="button" 
                                                    class="true-false-btn" 
                                                    [class.active]="question.answer === 'False'"
                                                    (click)="question.answer = 'False'">
                                                False
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </ng-template>
                </div>
            </div>

            <div class="action-buttons">
                <div class="left-buttons">
                    <button type="button" class="btn btn-secondary" (click)="savePrivate()">
                        Save Private
                    </button>
                    <button type="button" class="btn btn-primary" (click)="publishPublic()">
                        Publish Public
                    </button>
                    <button type="button" 
                            class="btn btn-secondary add-question-btn"
                            (click)="addQuestion()" 
                            [disabled]="questions.length >= MAX_QUESTIONS">
                        <span class="icon-small" aria-hidden="true">&#10133;</span>
                        Add Question
                    </button>
                </div>
                <button type="button" class="btn btn-cancel" (click)="close()">Cancel</button>
            </div>
        </div>
    </div>
</div>