<div class="dashboard-wrapper">
  <div class="dashboard-container">

    @if (isLoading) {
        <div class="loading-indicator">
            Loading Dashboard...
        </div>
    } @else {
      <section class="user-header-section">
        <div class="user-info">
          <h1 class="user-name">{{ userName }}</h1>
          <p class="user-email">{{ userEmail }}</p>
        </div>
        <div class="user-stats">
          <div class="stat-badge clickable" (click)="navigateToQuizzes()">
            <span class="stat-label">Quiz Sets</span>
            <span class="stat-number">{{ quizCount }}</span>
          </div>
          <div class="stat-badge clickable" (click)="navigateToFlashcards()">
            <span class="stat-label">Flashcard Sets</span>
            <span class="stat-number">{{ flashcardCount }}</span>
          </div>
        </div>
      </section>

      <section class="quick-actions-section">
        <div class="action-row">
          <h2 class="action-title">Create a Flashcard Set</h2>
          <button class="create-btn" (click)="createFlashcards()">Create</button>
        </div>
        
        <div class="divider"></div>
        
        <div class="action-row">
          <h2 class="action-title">Create a Quiz Set</h2>
          <button class="create-btn" (click)="createQuiz()">Create</button>
        </div>
      </section>

      <section class="recent-activity-section">
        <div class="section-header">
          <h2 class="section-title">Recent Activities</h2>
          <div class="header-actions">
            <span class="count-badge">{{ recentActivities.length }}</span>
            @if (recentActivities.length > 0) {
              <button class="reset-btn" (click)="resetActivities()" title="Clear all activities">
                Clear All
              </button>
            }
          </div>
        </div>
        <div class="activity-list">
          @if (recentActivities.length === 0) {
            <p class="empty-message">No recent activities</p>
          } @else {
            @for (activity of paginatedActivities; track activity.id) {
              <div class="activity-item" (click)="navigateToActivity(activity)">
                <div class="activity-content">
                  <span class="activity-title">{{ activity.title }}</span>
                  <span class="activity-subtitle">{{ getActivityDescription(activity) }}</span>
                </div>
                <button class="delete-btn" 
                        (click)="openDeleteModal(activity, $event)"
                        (mouseenter)="setHoverState(activity.id, true)"
                        (mouseleave)="setHoverState(activity.id, false)"
                        title="Delete activity">
                  <img [src]="getDeleteIconSrc(activity.id)" alt="Delete" class="delete-icon">
                </button>
              </div>
            }
          }
        </div>
        
        <div class="activities-pagination" [class.show]="activitiesTotalPages > 1">
          <button class="pagination-btn prev" 
                  (click)="goToActivitiesPage(0)" 
                  [disabled]="activitiesCurrentPage === 0">
            ‹‹
          </button>
          <button class="pagination-btn prev" 
                  (click)="previousActivitiesPage()" 
                  [disabled]="activitiesCurrentPage === 0">
            ‹
          </button>
          <div class="pagination-dots">
            @for (page of activitiesPages; track page) {
              <span [class]="page === '...' ? 'pagination-ellipsis' : 'pagination-dot'"
                    [class.active]="isPageNumber(page) && activitiesCurrentPage === page"
                    (click)="isPageNumber(page) && goToActivitiesPage(getPageNumber(page))">
                {{ getPageDisplay(page) }}
              </span>
            }
          </div>
          <button class="pagination-btn next" 
                  (click)="nextActivitiesPage()" 
                  [disabled]="activitiesCurrentPage === activitiesTotalPages - 1">
            ›
          </button>
          <button class="pagination-btn next" 
                  (click)="goToActivitiesPage(activitiesTotalPages - 1)" 
                  [disabled]="activitiesCurrentPage === activitiesTotalPages - 1">
            ››
          </button>
        </div>
      </section>
    }
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="confirm-overlay" [class.open]="isDeleteModalOpen" (click)="closeDeleteModal()">
  <div class="confirm-modal" (click)="$event.stopPropagation()">
    <p class="confirm-message">
      Are you sure to delete this item?<br>
      This action cannot be undone.
    </p>
    <div class="confirm-actions">
      <button class="btn-confirm-no" (click)="cancelDelete()">No</button>
      <button class="btn-confirm-yes" (click)="confirmDelete()">Yes, Delete</button>
    </div>
  </div>
</div>

<!-- Clear All Confirmation Modal -->
<div class="confirm-overlay" [class.open]="isClearAllModalOpen" (click)="closeClearAllModal()">
  <div class="confirm-modal" (click)="$event.stopPropagation()">
    <p class="confirm-message">
      Are you sure you want to clear all recent activities?<br>
      This action cannot be undone.
    </p>
    <div class="confirm-actions">
      <button class="btn-confirm-no" (click)="cancelClearAll()">No</button>
      <button class="btn-confirm-yes" (click)="confirmClearAll()">Yes, Clear All</button>
    </div>
  </div>
</div>
