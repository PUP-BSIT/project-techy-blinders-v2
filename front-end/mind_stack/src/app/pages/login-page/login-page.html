<app-nav-bar></app-nav-bar>

<div class="container">
    <div class="login-card">
        <div class="logo-class">
            <div class="header-class">
                <h1>Your Study Journey Starts Here!</h1>
            </div>

            <div class="image-class">
                <img src="assets/toga.png" alt="Logo">
            </div>
        </div>

        <div class="seperator-class"></div>

        <div class="login-form">
        <form [formGroup]="loginForm" (ngSubmit)="login()">
            <!-- Email -->
            <div class="email-class">
                <div><label>Email</label></div>
                <input formControlName="email" type="text" placeholder="Enter email...">

                @if (emailControl?.touched) {
                    @if(emailControl?.errors?.['required']) {
                        <p class="validators-message">Enter your email</p>
                    } @else if (emailControl?.errors?.['email']) {
                        <p class="validators-message">Invalid email format</p>
                    }
                }
            </div>

            <!-- Password -->
            <div class="password-class">
                <div><label>Password</label></div>
                <input formControlName="password" type="password" placeholder="Enter password...">

                @if (passwordControl?.touched) {
                    @if(passwordControl?.errors?.['required']) {
                        <p class="validators-message">Input a password</p>
                    }
                }
            </div>

            <!-- Error -->
            @if (errorMessage) {
                <div class="error-message"><span>{{ errorMessage }}</span></div>
            }

            <!-- Forgot password -->
                <div class="forgot-password">
                    <a (click)="forgotPasswordModal()" style="cursor: pointer;">
                        Forgot Password?
                    </a>
                </div>

                @if (showForgotPasswordModal) {
                    <div class="modal-overlay">
                        <app-forgot-password (onCancel)="closeModal()"></app-forgot-password>
                    </div>
                }

            <!-- Login button -->
            <div class="login-button">
                <button type="submit" [disabled]="!loginForm.valid || isLoading">Login</button>
            </div>

            <p class="register-class">Don't have an account? <a routerLink="/register"> Register</a></p>
        </form>
        </div>
    </div>

    @if (successModalOpen()) {
        <div class="modal-backdrop"></div>

        <div class="success-modal">
            <div class="modal-content">
                <!-- Spinner -->
                <div class="spinner"></div>
                <h2>Logging In...</h2>
                <p>Please wait</p>
            </div>
        </div>
    }
</div>