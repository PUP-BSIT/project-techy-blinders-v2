<div class="comments-section">
  @for (comment of comments; track comment.comment_id) {
    <div class="comment-item">
      <div class="comment-header">
        <div class="user-avatar">{{ getInitial(comment.username) }}</div>
        <div class="comment-info">
          <span class="username">{{ comment.username }}</span>
          <span class="timestamp"> Â· {{ getTimeAgo(comment.created_at) }}</span>
        </div>
      </div>
      <p class="comment-content">{{ comment.content }}</p>
      <div class="comment-actions">
        <button 
          class="action-btn"
          [class.active]="comment.userLiked"
          (click)="onLikeComment(comment)"
        >
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="1.5"/>
            <path d="M8 11L5.5 8.5H7V5.5H9V8.5H10.5L8 11Z" fill="currentColor" transform="rotate(180 8 8.25)"/>
          </svg>
          <span>{{ comment.likes }}</span>
        </button>
        <button 
          class="action-btn"
          [class.active]="comment.userDisliked"
          (click)="onDislikeComment(comment)"
        >
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="1.5"/>
            <path d="M8 11L5.5 8.5H7V5.5H9V8.5H10.5L8 11Z" fill="currentColor"/>
          </svg>
          <span>{{ comment.dislikes }}</span>
        </button>
        <button class="action-btn">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M2 8L8 2L14 8M8 2V14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span>{{ comment.likes + comment.dislikes }}</span>
        </button>
      </div>
    </div>
  }

  <div class="add-comment">
    <div class="user-avatar-small">{{ currentUserInitial }}</div>
    <input 
      type="text"
      class="comment-input"
      placeholder="Add your Reply"
      [(ngModel)]="newCommentText"
      (keyup.enter)="onAddComment()"
    />
    <button 
      class="send-btn"
      [disabled]="!newCommentText.trim()"
      (click)="onAddComment()"
    >
      <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
        <path d="M15 1L7 9M15 1L10 15L7 9M15 1L1 6L7 9"/>
      </svg>
    </button>
  </div>
</div>