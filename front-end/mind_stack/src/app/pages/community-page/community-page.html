<div class="community-container" 
      [class.sidebar-collapsed]="isSidebarCollapsed">
  <div class="community-content">
    <app-search (searchChange)="onSearchChange($event)" />

    <div class="posts-list">
      @for (post of filteredPosts; track post.post_id) {
        <app-post-card
          [post]="post"
          [currentUserInitial]="currentUserInitial"
          [currentUserId]="currentUserId"
          [now]="now"
          (openModal)="openPostModal($event)"
          (likePost)="onLikePost($event)"
          (dislikePost)="onDislikePost($event)"
          (deletePost)="onDeletePost($event)"
          (editPost)="onEditPost($event)"
        />
      } @empty {
        <div class="no-posts">
          <p>No posts found. Be the first to create one!</p>
        </div>
      }
    </div>
  </div>

  @if (showCreateModal) {
    <app-create-post
      [editPost]="editingPost"
      (closeModalEvent)="closeCreateModal()"
      (createPost)="onCreatePost($event)"
      (updatePost)="onUpdatePost($event)"
    />
  }

  @if (showPostModal && selectedPost) {
    <app-post-modal
      [post]="selectedPost"
      [comments]="getCommentsForPost(selectedPost.post_id)"
      [currentUserInitial]="currentUserInitial"
      [currentUserId]="currentUserId"
      [now]="now"
      [focusCommentId]="pendingCommentId || undefined"
      (closeModalEvent)="closePostModal()"
      (likePost)="onLikePostInModal()"
      (dislikePost)="onDislikePostInModal()"
      (editPost)="onEditPost(selectedPost)"
      (deletePost)="onDeletePost($event)"
      (addComment)="onAddComment($event)"
      (likeComment)="onLikeComment($event)"
      (dislikeComment)="onDislikeComment($event)"
      (editComment)="onEditComment($event)"
      (deleteComment)="onDeleteComment($event)"
    />
  }
</div>